

if(BUILD_MPIN)

  # Configure go mpin wrapper
  configure_file (
    "${CMAKE_CURRENT_SOURCE_DIR}/mpin.go.in"
    "${CMAKE_CURRENT_BINARY_DIR}/mpin.go"
  )

  file(COPY mpin_test.go DESTINATION "${CMAKE_CURRENT_BINARY_DIR}")

  add_test(NAME test_golang_mpin COMMAND go test)
  set_tests_properties (test_golang_mpin PROPERTIES PASS_REGULAR_EXPRESSION PASS)

  INSTALL(DIRECTORY DESTINATION "${GO_PATH}/src/github.com/milagro" DIRECTORY_PERMISSIONS
          OWNER_WRITE OWNER_READ OWNER_EXECUTE
          GROUP_WRITE GROUP_READ
          WORLD_WRITE WORLD_READ WORLD_EXECUTE)

  INSTALL(DIRECTORY DESTINATION "${GO_PATH}/src/github.com/milagro/mpin" DIRECTORY_PERMISSIONS
          OWNER_WRITE OWNER_READ OWNER_EXECUTE
          GROUP_WRITE GROUP_READ
          WORLD_WRITE WORLD_READ WORLD_EXECUTE)

  INSTALL(FILES ${CMAKE_CURRENT_BINARY_DIR}/mpin.go mpin_test.go  DESTINATION "${GO_PATH}/src/github.com/milagro/mpin" PERMISSIONS
          OWNER_WRITE OWNER_READ OWNER_EXECUTE
          GROUP_READ GROUP_EXECUTE
          WORLD_READ WORLD_EXECUTE)

endif(BUILD_MPIN)

